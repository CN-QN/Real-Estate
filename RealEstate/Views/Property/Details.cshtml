
@using RealEstate.Utils

@model RealEstate.Models.ViewModels.PropertyDetailViewModel

@{
    ViewBag.Title = Model.Title;
}

<!-- Swiper CSS -->
<link rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />

<div class="container">
    <div>
        <!-- GALLERY -->
        <div class="gallery-wrapper">
            <!-- Ảnh lớn -->
            <div class="swiper mySwiperMain">
                <div class="swiper-wrapper">
                    @foreach (var item in Model.ImageGallery)
                    {
                        <div class="swiper-slide">
                            <img src="@item.ImageUrl" alt="Property Image" />
                        </div>
                    }
                </div>

                <div class="swiper-button-next"></div>
                <div class="swiper-button-prev"></div>
            </div>

            <!-- Ảnh nhỏ bên phải -->
            <div class="swiper mySwiperThumbs">
                <div class="swiper-wrapper">
                    @foreach (var item in Model.ImageGallery)
                    {
                        <div class="swiper-slide">
                            <img src="@item.ImageUrl" alt="Thumbnail" />
                        </div>
                    }
                </div>
            </div>
        </div>

        <!-- PHẦN NỘI DUNG -->
        <div class="property-container">
            <div class="main">
                <div class="title">
                    @Model.Title
                </div>
                <div class="subtitle">
                    Bán Nhà riêng Đường Bông Sao - Phường 5, Quận 8, TP Hồ Chí Minh
                </div>

                <div class="price-area">
                    <div class="price">
                        Giá
                        @{
                            if (Model.PriceMin == 0 && Model.PriceMax == 0)
                            {
                                @Model.PriceUnit
                            }
                            else if (Model.PriceMax == Model.PriceMin)
                            {
                                @($"{FormatNumber.Num(Model.PriceMin)} {Model.PriceUnit}")
                            }
                            else
                            {
                                @($"{FormatNumber.Num(Model.PriceMin)} - {FormatNumber.Num(Model.PriceMax)} {Model.PriceUnit}")
                            }
                        }
                    </div>
                    <div class="area">
                        Diện tích @Model.AreaMin - @Model.AreaMax @Model.AreaUnit
                    </div>
                </div>

                <div class="actions">
                    <button>Lưu tin</button>
                    <button>Chia sẻ</button>
                    <button>Báo xấu</button>
                </div>

                <div class="section-title">Thông tin mô tả</div>
                <div class="desc-box">
                    @Model.Description
                </div>
            </div>

            <!-- SIDEBAR -->
            <div class="sidebar">
                <div class="contact-box">
                    <div class="property-users">
                        <p><img src="@Model.Avatar" alt="Alternate Text" /></p>
                        <p>@Model.NameUser</p>
                    </div>

                    <div class="phone-btn" onclick="showPhone('@Model.Phone')">
                        <p><i class="fa-solid fa-phone"></i></p>
                        <div>
                            <p class="phone">
                                @(Model.Phone.Substring(0, Model.Phone.Length - 3) + "***")
                            </p>
                            <p>Nhấp để hiện số</p>
                        </div>
                    </div>
                </div>

                <div class="related-box">
                    <div class="section-title">Bán Nhà riêng tại Quận 8, TP Hồ Chí Minh</div>
                    <ul>
                        <li><a href="#">Bán Nhà riêng Phường 1</a></li>
                        <li><a href="#">Bán Nhà riêng Phường 10</a></li>
                        <li><a href="#">Bán Nhà riêng Phường 11</a></li>
                        <li><a href="#">Bán Nhà riêng Phường 12</a></li>
                        <li><a href="#">Bán Nhà riêng Phường 13</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Swiper JS -->
<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

<script>
    const swiperThumbs = new Swiper(".mySwiperThumbs", {
        spaceBetween: 10,
        slidesPerView: 3,
        direction: "vertical",
        watchSlidesProgress: true,
    });

    const swiperMain = new Swiper(".mySwiperMain", {
        spaceBetween: 10,
        navigation: {
            nextEl: ".swiper-button-next",
            prevEl: ".swiper-button-prev",
        },
        thumbs: {
            swiper: swiperThumbs,
        },
    });

    function showPhone(Phone) {
        document.querySelector('.phone-btn .phone').innerText = Phone;
    }
</script>

<style>
    /* Layout gallery */
    .gallery-wrapper {
        display: flex;
        gap: 15px;
        justify-content: center;
        align-items: flex-start;
        max-width: 1000px;
        margin: 20px auto;
    }

    .mySwiperMain {
        width: 75%;
        height: 400px;
        border-radius: 10px;
        overflow: hidden;
    }

    .mySwiperThumbs {
        width: 25%;
        height: 400px;
    }

    .swiper-slide img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        border-radius: 8px;
        cursor: pointer;
    }

    .mySwiperThumbs .swiper-slide {
        height: calc((400px - 20px) / 3);
        opacity: 0.6;
        transition: opacity 0.3s;
    }

    .mySwiperThumbs .swiper-slide-thumb-active {
        opacity: 1;
        border: 2px solid #007bff;
    }

    .swiper-button-next,
    .swiper-button-prev {
        color: #fff;
    }

    .swiper-pagination-bullet-active {
        background: #007bff;
    }
</style>
